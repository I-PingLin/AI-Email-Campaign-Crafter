<div class="bg-white p-6 sm:p-8 rounded-xl shadow-md space-y-6">
  
  <!-- Input Section -->
  <div>
    <label for="prompt" class="block text-lg font-medium text-gray-800 mb-2">
      What's your campaign about?
    </label>
    <textarea
      id="prompt"
      [value]="prompt()"
      (input)="updatePrompt($event)"
      rows="4"
      class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out"
      placeholder="e.g., A flash sale for our new summer shoe collection..."
    ></textarea>
  </div>

  <!-- Image Size Selector -->
  <div>
    <label class="block text-lg font-medium text-gray-800 mb-2">
      Image Size
    </label>
    <div class="flex flex-wrap gap-2">
      @for (size of imageSizes; track size.value) {
        <button
          (click)="setImageSize(size.value)"
          [class]="'px-4 py-2 rounded-lg transition-colors ' + (selectedImageSize() === size.value ? 'bg-indigo-600 text-white shadow' : 'bg-gray-200 text-gray-700 hover:bg-gray-300')"
        >
          {{ size.label }}
        </button>
      }
    </div>
  </div>

  <button
    (click)="generateCampaign()"
    [disabled]="isLoading() || !prompt().trim()"
    class="w-full flex items-center justify-center bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-300 disabled:cursor-not-allowed transition-all duration-300"
  >
    @if (isLoading()) {
      <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      Generating...
    } @else {
      <span>âœ¨ Generate Campaign</span>
    }
  </button>

  @if (error()) {
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg" role="alert">
      <p>{{ error() }}</p>
    </div>
  }
</div>

<!-- Results Section -->
@if (isLoading()) {
  <div class="mt-8 bg-white p-6 sm:p-8 rounded-xl shadow-md animate-pulse">
    <div class="h-4 bg-gray-200 rounded w-1/4 mb-4"></div>
    <div class="h-3 bg-gray-200 rounded w-full mb-2"></div>
    <div class="h-3 bg-gray-200 rounded w-5/6 mb-6"></div>

    <div class="h-4 bg-gray-200 rounded w-1/3 mb-4"></div>
    <div class="h-3 bg-gray-200 rounded w-full mb-2"></div>
    <div class="h-3 bg-gray-200 rounded w-full mb-2"></div>
    <div class="h-3 bg-gray-200 rounded w-3/4 mb-6"></div>

    <div class="aspect-video bg-gray-200 rounded-lg"></div>
  </div>
}

@if (campaignResult(); as result) {
  <div class="mt-8 bg-white p-6 sm:p-8 rounded-xl shadow-md space-y-6">
    <h2 class="text-2xl font-bold text-gray-900 border-b pb-2">Your Generated Campaign</h2>

    <!-- Subject Lines -->
    <div>
      <h3 class="text-xl font-semibold text-gray-800 mb-2">Subject Lines</h3>
      <ul class="list-disc list-inside space-y-1 text-gray-700">
        @for (subject of result.subjectLines; track subject) {
          <li>{{ subject }}</li>
        }
      </ul>
    </div>

    <!-- Body -->
    <div>
      <h3 class="text-xl font-semibold text-gray-800 mb-2">Email Body</h3>
      <div class="prose prose-indigo max-w-none p-4 border rounded-lg bg-gray-50 text-gray-800" style="white-space: pre-wrap;">{{ result.body }}</div>
    </div>

    <!-- Image -->
    <div>
      <h3 class="text-xl font-semibold text-gray-800 mb-2">Generated Visual</h3>
      <img [src]="result.imageUrl" alt="Generated campaign visual" class="rounded-lg shadow-md w-full object-contain" />
    </div>
  </div>
}
