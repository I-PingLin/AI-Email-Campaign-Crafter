<div class="w-80 sm:w-96 h-[32rem] bg-white rounded-xl shadow-2xl flex flex-col transition-all duration-300 ease-in-out">
  <!-- Header -->
  <div class="flex items-center justify-between p-3 border-b bg-gray-50 rounded-t-xl">
    <h3 class="text-lg font-semibold text-gray-800">Marketing Assistant</h3>
    <button (click)="closeChat.emit()" class="text-gray-400 hover:text-gray-600">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>
  </div>

  <!-- Chat History -->
  <div #chatHistory class="flex-1 p-4 overflow-y-auto space-y-4">
    @for (message of messages(); track $index) {
      <div class="flex" [class]="message.author === 'user' ? 'justify-end' : 'justify-start'">
        <div 
          class="max-w-xs md:max-w-md px-4 py-2 rounded-2xl"
          [class]="message.author === 'user' ? 'bg-indigo-500 text-white rounded-br-none' : 'bg-gray-200 text-gray-800 rounded-bl-none'"
        >
          <p class="text-sm" style="white-space: pre-wrap;">{{ message.content }}</p>
        </div>
      </div>
    }
    @if (isBotTyping()) {
      <div class="flex justify-start">
        <div class="bg-gray-200 text-gray-800 rounded-2xl rounded-bl-none px-4 py-3">
          <div class="flex items-center space-x-1">
            <span class="h-1.5 w-1.5 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.3s]"></span>
            <span class="h-1.5 w-1.5 bg-gray-400 rounded-full animate-pulse [animation-delay:-0.15s]"></span>
            <span class="h-1.5 w-1.5 bg-gray-400 rounded-full animate-pulse"></span>
          </div>
        </div>
      </div>
    }
  </div>

  <!-- Input Area -->
  <div class="p-3 border-t bg-gray-50 rounded-b-xl">
    <div class="flex items-center space-x-2">
      <input
        type="text"
        placeholder="Type a message..."
        class="flex-1 w-full px-3 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500"
        [value]="currentUserMessage()"
        (input)="updateUserMessage($event)"
        (keyup.enter)="sendMessage()"
      />
      <button
        (click)="sendMessage()"
        [disabled]="!currentUserMessage().trim() || isBotTyping()"
        class="bg-indigo-600 text-white rounded-full p-2 hover:bg-indigo-700 disabled:bg-indigo-300 disabled:cursor-not-allowed transition-colors"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
          <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
        </svg>
      </button>
    </div>
  </div>
</div>
